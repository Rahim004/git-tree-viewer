#!/bin/bash

# –ù–∞–∑–≤–∞–Ω–∏–µ: git-tree.sh
# –û–ø–∏—Å–∞–Ω–∏–µ: –°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ä–µ–≤–æ –≤–µ—Ç–æ–∫ –∏ –∫–æ–º–º–∏—Ç–æ–≤ –≤ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
# –ê–≤—Ç–æ—Ä: –î–ª—è —É—á–µ–±–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
# –í–µ—Ä—Å–∏—è: 1.0

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
print_header() {
    echo "========================================"
    echo "      GIT –†–ï–ü–û–ó–ò–¢–û–†–ò–ô: –î–ï–†–ï–í–û –ò–°–¢–û–†–ò–ò     "
    echo "========================================"
    echo ""
}

# –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞
main() {
    # –í—ã–≤–æ–¥–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
    print_header

    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ Git
    # –ö–æ–º–∞–Ω–¥–∞ `git rev-parse --git-dir` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ .git, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å.
    # –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–∞–Ω–¥—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ "–Ω–∏–∫—É–¥–∞" (/dev/null), —á—Ç–æ–±—ã –Ω–µ –≤–∏–¥–µ—Ç—å –æ—à–∏–±–æ–∫ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.
    if ! git rev-parse --git-dir > /dev/null 2>&1; then
        echo "‚ùå –û—à–∏–±–∫–∞: –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º."
        echo ""
        echo "–°–æ–≤–µ—Ç—ã:"
        echo "  ‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞, –≥–¥–µ –µ—Å—Ç—å —Å–∫—Ä—ã—Ç–∞—è –ø–∞–ø–∫–∞ .git."
        echo "  ‚Ä¢ –ò–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∑–¥–µ—Å—å –∫–æ–º–∞–Ω–¥–æ–π: git init"
        echo ""
        exit 1
    fi

    # 2. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, –≤ –∫–∞–∫–æ–π –ø–∞–ø–∫–µ –º—ã —Å–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞–µ–º
    current_dir=$(pwd)
    echo "üìÅ –¢–µ–∫—É—â–∞—è —Ä–∞–±–æ—á–∞—è –ø–∞–ø–∫–∞: $current_dir"
    echo ""

    # 3. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –∞–∫—Ç–∏–≤–Ω—É—é –≤–µ—Ç–∫—É
    # –§–ª–∞–≥ `--show-current` —Ç–æ—á–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è –≤–µ—Ç–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –º—ã —Å–µ–π—á–∞—Å.
    current_branch=$(git branch --show-current)
    echo "üåø –¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞: $current_branch"
    echo ""

    # 4. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ä–µ–≤–æ –≤—Å–µ—Ö –≤–µ—Ç–æ–∫ –∏ –∫–æ–º–º–∏—Ç–æ–≤
    echo "üå≥ –î–µ—Ä–µ–≤–æ –∫–æ–º–º–∏—Ç–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 15 –∑–∞–ø–∏—Å–µ–π):"
    echo "   (–°–∏–º–≤–æ–ª * –æ—Ç–º–µ—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É, –ª–∏–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∏—Å—Ç–æ—Ä–∏—é)"
    echo "--------------------------------------------------------------------"
    # –ö–ª—é—á–µ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
    #   --graph: –†–∏—Å—É–µ—Ç ASCII-–≥—Ä–∞—Ñ –≤–µ—Ç–≤–ª–µ–Ω–∏—è —Å–ª–µ–≤–∞ –æ—Ç –∫–æ–º–º–∏—Ç–æ–≤.
    #   --oneline: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π –∫–æ–º–º–∏—Ç –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π —Ö—ç—à –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ).
    #   --all: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –≤–µ—Ç–æ–∫, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–µ–π.
    #   --decorate: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª–∏ –≤–µ—Ç–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, main, feature).
    #   -15: –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–≤–æ–¥ –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ 15 –∫–æ–º–º–∏—Ç–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —ç–∫—Ä–∞–Ω.
    git log --graph --oneline --all --decorate -15
    echo "--------------------------------------------------------------------"
    echo ""

    # 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –≤—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –≤–µ—Ç–æ–∫
    echo "üìã –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –≤–µ—Ç–æ–∫:"
    echo "   (–ó–≤–µ–∑–¥–æ—á–∫–∞ * —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É)"
    # –ö–æ–º–∞–Ω–¥–∞ `git branch` –±–µ–∑ —Ñ–ª–∞–≥–æ–≤ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç –≤–µ—Ç–∫–∏.
    # –§–ª–∞–≥ `-v` (verbose) –¥–æ–±–∞–≤–∏—Ç –∫ –≤—ã–≤–æ–¥—É –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç –≤ –∫–∞–∂–¥–æ–π –≤–µ—Ç–∫–µ.
    git branch -v
    echo ""

    # 6. –ó–∞–≤–µ—Ä—à–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    echo "‚úÖ –ì–æ—Ç–æ–≤–æ. –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: git log --graph --oneline --all"
}

# –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
main
