#!/bin/bash

# =========================================
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ Git-–≤–µ—Ç–æ–∫
# –ê–≤—Ç–æ—Ä: –í–∞—à–µ –ò–º—è
# –í–µ—Ä—Å–∏—è: 2.0 (—Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—É—Å—Ç—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤)
# =========================================

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞
print_header() {
    echo "========================================"
    echo "   –ê–ù–ê–õ–ò–ó GIT-–†–ï–ü–û–ó–ò–¢–û–†–ò–Ø"
    echo "========================================"
    echo ""
}

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
main() {
    print_header
    
    # –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä—è–µ–º, Git –ª–∏ —ç—Ç–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
    
    if [ ! -d ".git" ]; then
        echo ""
        echo "‚ùå –û–®–ò–ë–ö–ê: –≠—Ç–æ –Ω–µ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π!"
        echo "-----------------------------------"
        echo "–í —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –ø–∞–ø–∫–∞ .git"
        echo ""
        echo "–ß—Ç–æ –¥–µ–ª–∞—Ç—å:"
        echo "1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å Git-–ø—Ä–æ–µ–∫—Ç–æ–º"
        echo "2. –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: git init"
        echo ""
        exit 1
    fi
    
    echo "‚úÖ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞–π–¥–µ–Ω!"
    echo ""
    
    # –®–ê–ì 2: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–æ–º–º–∏—Ç—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
    echo "üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
    
    if git rev-parse --verify HEAD >/dev/null 2>&1; then
        echo "‚úÖ –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å –∫–æ–º–º–∏—Ç—ã"
        has_commits=true
    else
        echo "‚ö†Ô∏è  –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—É—Å—Ç (–Ω–µ—Ç –∫–æ–º–º–∏—Ç–æ–≤)"
        has_commits=false
    fi
    echo ""
    
    # –®–ê–ì 3: –ü–æ–ª—É—á–∞–µ–º –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
    repo_name=$(basename "$(pwd)")
    echo "üìÅ –ò–º—è –ø–∞–ø–∫–∏: $repo_name"
    echo ""
    
    # –®–ê–ì 4: –†–∞–±–æ—Ç–∞–µ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
    if [ "$has_commits" = false ]; then
        # –°–ª—É—á–∞–π 1: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—É—Å—Ç (–Ω–µ—Ç –∫–æ–º–º–∏—Ç–æ–≤)
        echo "üìã –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ü–£–°–¢–û–ú –†–ï–ü–û–ó–ò–¢–û–†–ò–ò:"
        echo "========================================"
        echo "–°—Ç–∞—Ç—É—Å: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω, –Ω–æ –Ω–µ—Ç –∫–æ–º–º–∏—Ç–æ–≤"
        echo ""
        echo "–¢–µ–∫—É—â–∏–µ —Ñ–∞–π–ª—ã (–Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Git):"
        echo "----------------------------------------"
        git status --short
        echo "----------------------------------------"
        echo ""
        echo "üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
        echo "1. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª—ã: git add <–∏–º—è_—Ñ–∞–π–ª–∞>"
        echo "2. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç: git commit -m '–ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç'"
        echo "3. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–µ—Ç–∫–∏"
        echo ""
        
    else
        # –°–ª—É—á–∞–π 2: –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å –∫–æ–º–º–∏—Ç—ã
        # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É
        current_branch=$(git branch --show-current 2>/dev/null || echo "(no branch)")
        
        echo "üìç –¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞: $current_branch"
        echo ""
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ä–µ–≤–æ –∫–æ–º–º–∏—Ç–æ–≤
        echo "üå≥ –î–ï–†–ï–í–û –ö–û–ú–ú–ò–¢–û–í (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 15):"
        echo "========================================"
        
        if [ "$(git log --oneline -1 2>/dev/null | wc -l)" -eq 0 ]; then
            echo "–ù–µ—Ç –∫–æ–º–º–∏—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"
        else
            echo "–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:"
            echo "  * ‚Äî –∫–æ–º–º–∏—Ç"
            echo "  | ‚Äî –≤–µ—Ç–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è"
            echo "  / ‚Äî –≤–µ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–≤–ª—è–µ—Ç—Å—è"
            echo "  (HEAD -> –≤–µ—Ç–∫–∞) ‚Äî –≤–∞—à–µ —Ç–µ–∫—É—â–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ"
            echo "----------------------------------------"
            git log --graph --oneline --all --decorate -15 2>/dev/null || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤"
            echo "----------------------------------------"
        fi
        echo ""
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –≤–µ—Ç–∫–∏
        echo "üìã –°–ü–ò–°–û–ö –í–°–ï–• –í–ï–¢–û–ö:"
        echo "========================================"
        
        branch_output=$(git branch -av 2>/dev/null)
        if [ -z "$branch_output" ]; then
            echo "–ù–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –≤–µ—Ç–æ–∫"
            echo "(–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 'git checkout -b –∏–º—è_–≤–µ—Ç–∫–∏' —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é)"
        else
            echo "–§–æ—Ä–º–∞—Ç: [—Ç–∏–ø] –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–µ—Ç–∫–∏     –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç"
            echo "----------------------------------------"
            echo "$branch_output"
            echo "----------------------------------------"
        fi
        echo ""
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
        echo "üìä –°–¢–ê–¢–£–° –†–ï–ü–û–ó–ò–¢–û–†–ò–Ø:"
        echo "========================================"
        git status --short 2>/dev/null || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å"
        echo ""
    fi
    
    # –®–ê–ì 5: –ó–∞–≤–µ—Ä—à–∞–µ–º —Å–∫—Ä–∏–ø—Ç
    echo "‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω!"
    echo ""
}

# –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
main
